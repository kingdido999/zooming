!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Zooming=t()}(this,function(){"use strict";var e=document.body,t=document.documentElement,n="WebkitAppearance"in document.documentElement.style?"-webkit-":"",o=function(e){return function(t){return t/e}},r=o(2),i=function(e,t){var n=new Image;n.onload=function(){t&&t(n)},n.src=e},a=function(){return window.pageYOffset||(t||e.parentNode||e).scrollTop},s=function(){var n=t.clientWidth||e.clientWidth,o=t.clientHeight||e.clientHeight;return{x:r(n),y:r(o)}},u=function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t.forEach(function(t){o?e.addEventListener(t,n[t]):e.removeEventListener(t,n[t])})},l=200,c=2,d=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],f={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeMove:null,onBeforeRelease:null},m={target:{close:null,open:null},overlay:{init:{zIndex:998,backgroundColor:f.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n        "+f.transitionDuration+"s\n        "+f.transitionTimingFunction}},cursor:{default:"auto",zoomIn:n+"zoom-in",zoomOut:n+"zoom-out",grab:n+"grab",move:"move"}},v=function(e){var t={},n=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return n.some(function(n){if(void 0!==e.style[n])return t.transitionProp=n,t.transEndEvent=r[n],!0}),o.some(function(n){if(void 0!==e.style[n])return t.transformProp=n,t.transformCssProp=n.replace(/(.*)Transform/,"-$1-transform"),!0}),t},g=function(e,t){return function(n,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[e]=i),o.transform&&(i=o.transform,delete o.transform,o[t]=i);var a=n.style,s={};for(var u in o)r&&(s[u]=a[u]||""),a[u]=o[u];return s}},p=function(e){var t=s(),n={x:e.left+r(e.width),y:e.top+r(e.height)};return{x:t.x-n.x,y:t.y-n.y}},y=function(e,t){var n=s(),o=r(e.width),i=r(e.height),a={x:n.x-o,y:n.y-i},u=a.x/o,l=a.y/i;return t+Math.min(u,l)},b=function(e,t){for(var n=e.length,o=e[0],r=n>1,i=f.scaleExtra,a=e.length,s=0,u=0,l={x:o.clientX,y:o.clientY},d={x:o.clientX,y:o.clientY};a--;){var m=e[a],v=[m.clientX,m.clientY],g=v[0],p=v[1];s+=g,u+=p,r&&(g<l.x?l.x=g:g>d.x&&(d.x=g),p<l.y?l.y=p:p>d.y&&(d.y=p))}if(r){var y=d.x-l.x,b=d.y-l.y;i=y>b?y/window.innerWidth*c:b/window.innerHeight*c}t(s/n,u/n,i)},h=void 0,x=document.body,E=document.createElement("div"),T=void 0,w=void 0,L=!1,k=!1,C=!0,B=null,z=void 0,A=void 0,O=void 0,I=void 0,G=v(E),D=G.transformCssProp,M=G.transEndEvent,P=g(G.transitionProp,G.transformProp),R=function(e,t,n){return P(e,t,n)},W={click:function(e){e.preventDefault(),L?C?Y.close():Y.release():Y.open(e.currentTarget)},scroll:function(){var e=a();null===B&&(B=e);var t=B-e;Math.abs(t)>=f.scrollThreshold&&(B=null,Y.close())},keydown:function(e){var t=e.key||e.code;"Escape"!==t&&27!==e.keyCode||(C?Y.close():Y.release(function(){return Y.close()}))},mousedown:function(e){0===e.button&&(e.preventDefault(),I=setTimeout(function(){Y.grab(e.clientX,e.clientY)},l))},mousemove:function(e){C||Y.move(e.clientX,e.clientY)},mouseup:function(e){0===e.button&&(clearTimeout(I),C?Y.close():Y.release())},touchstart:function(e){e.preventDefault(),I=setTimeout(function(){b(e.touches,function(e,t,n){Y.grab(e,t,n)})},l)},touchmove:function(e){C||b(e.touches,function(e,t,n){Y.move(e,t,n)})},touchend:function(e){e.targetTouches.length>0||(clearTimeout(I),C?Y.close():Y.release())}},Y={listen:function(e){if("string"==typeof e){for(var t=document.querySelectorAll(e),n=t.length;n--;)Y.listen(t[n]);return h}if("IMG"===e.tagName)return e.style.cursor=m.cursor.zoomIn,e.addEventListener("click",W.click),f.preloadImage&&e.hasAttribute("data-original")&&i(e.getAttribute("data-original")),h},config:function(e){if(!e)return f;for(var t in e)f[t]=e[t];return R(E,{backgroundColor:f.bgColor,transition:"opacity\n        "+f.transitionDuration+"s\n        "+f.transitionTimingFunction}),h},open:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.onOpen;if(!L&&!k&&(T="string"==typeof e?document.querySelector(e):e,"IMG"===T.tagName)){f.onBeforeOpen&&f.onBeforeOpen(T),L=!0,k=!0,w=T.parentNode,!f.preloadImage&&T.hasAttribute("data-original")&&i(T.getAttribute("data-original"));var n=T.getBoundingClientRect();return z=p(n),A=y(n,f.scaleBase),T.offsetWidth,m.target.open={position:"relative",zIndex:999,cursor:f.enableGrab?m.cursor.grab:m.cursor.zoomOut,transition:D+"\n        "+f.transitionDuration+"s\n        "+f.transitionTimingFunction,transform:"translate("+z.x+"px, "+z.y+"px) scale("+A+")"},m.target.close=R(T,m.target.open,!0),w.appendChild(E),setTimeout(function(){return E.style.opacity=f.bgOpacity},30),document.addEventListener("scroll",W.scroll),document.addEventListener("keydown",W.keydown),T.addEventListener(M,function e(){T.removeEventListener(M,e),k=!1,f.enableGrab&&u(document,d,W,!0),T.hasAttribute("data-original")&&!function(){O=T.getAttribute("src");var e=T.getAttribute("data-original"),t=T.cloneNode(!1);t.setAttribute("src",e),t.style.position="absolute",t.style.visibility="hidden",x.appendChild(t),setTimeout(function(){T.setAttribute("src",e),x.removeChild(t)},10)}(),t&&t(T)}),h}},close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.onClose;if(L&&!k)return f.onBeforeClose&&f.onBeforeClose(T),k=!0,T.offsetWidth,x.style.cursor=m.cursor.default,E.style.opacity=0,R(T,{transform:"none"}),document.removeEventListener("scroll",W.scroll),document.removeEventListener("keydown",W.keydown),T.addEventListener(M,function t(){T.removeEventListener(M,t),L=!1,k=!1,f.enableGrab&&u(document,d,W,!1),T.hasAttribute("data-original")&&T.setAttribute("src",O),R(T,m.target.close),w.removeChild(E),e&&e(T)}),h},grab:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.scaleExtra,o=arguments[3];if(L&&!k){f.onBeforeGrab&&f.onBeforeGrab(T),C=!1;var r=s(),i=r.x-e,a=r.y-t;R(T,{cursor:m.cursor.move,transform:"translate("+(z.x+i)+"px, "+(z.y+a)+"px)\n        scale("+(A+n)+")"}),T.addEventListener(M,function e(){T.removeEventListener(M,e),o&&o(T)})}},move:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.scaleExtra,o=arguments[3];if(L&&!k){f.onBeforeMove&&f.onBeforeMove(T),C=!1;var r=s(),i=r.x-e,a=r.y-t;R(T,{transition:D,transform:"translate("+(z.x+i)+"px, "+(z.y+a)+"px)\n        scale("+(A+n)+")"}),x.style.cursor=m.cursor.move,T.addEventListener(M,function e(){T.removeEventListener(M,e),o&&o(T)})}},release:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.onRelease;if(L&&!k)return f.onBeforeRelease&&f.onBeforeRelease(T),k=!0,R(T,m.target.open),x.style.cursor=m.cursor.default,T.addEventListener(M,function t(){T.removeEventListener(M,t),k=!1,C=!0,e&&e(T)}),h}};return R(E,m.overlay.init),E.setAttribute("id","zoom-overlay"),E.addEventListener("click",function(){return Y.close()}),document.addEventListener("DOMContentLoaded",function(){Y.listen(f.defaultZoomable)}),Y});
//# sourceMappingURL=zooming.min.js.map
